if(typeof console===undefined){console={log:function(){},warn:function(){},error:function(){}}}funcmaster_onload=function(){var removeCommandTextHandler=function(){jQuery("#commandsText").css("display","none")};jQuery("#commandsText").blur(removeCommandTextHandler);jQuery("#frameHolder").load(preparePageEvents);preparePageEvents()};var eventsToListen=new Array();function addEventsToListen(tagName,eventName,alternativeHandlerMethod){var eventToListen=new Object();eventToListen.tagName=tagName;eventToListen.eventName=eventName;if(alternativeHandlerMethod){eventToListen.alternativeHandlerMethod=alternativeHandlerMethod}eventsToListen[eventsToListen.length]=eventToListen}function preparePageEvents(){var delayedClosure=function(){jQuery("#currentUrl").val(idoc().location);for(var j=0;j<eventsToListen.length;j++){var anchors=idoc().getElementsByTagName(eventsToListen[j].tagName);for(var i=0;i<anchors.length;i++){if(eventsToListen[j].alternativeHandlerMethod){jQuery(anchors[i])[eventsToListen[j].eventName](eventsToListen[j].alternativeHandlerMethod)}else{jQuery(anchors[i])[eventsToListen[j].eventName](handleNewEvent)}}}};delayedClosure()}function idoc(){return frames["frameHolder"].document}function ifr(){return frames["frameHolder"]}function loadPage(){jQuery("#frameHolder").attr("src",jQuery("#currentUrl").val());return false}function handleNewEvent(e){var o=e.currentTarget;var url="http://localhost:8080/jira/secure/FuncTestWriterAddEvent.jspa";var pars="decorator=none";if(o.id){pars=pars+"&elementId="+o.id}pars=pars+"&tagName="+o.nodeName;pars=pars+"&eventType="+e.type;pars=pars+"&innerHtml="+o.innerHTML;info("Params: "+pars);callAjax(url,pars);return true}function callAjax(url,pars){var hiddenIframe=frames["hiddenIFrame"];jQuery("#hiddenIFrame").load(handleDodgyAjax);hiddenIframe.window.location=url+"?"+pars}function handleDodgyAjax(){var hiddenIframe=frames["hiddenIFrame"];var data=hiddenIframe.document.getElementById("data");if(data&&data.innerHTML&&data.innerHTML!=""){info("Response: "+data.innerHTML);addToList(data.innerHTML)}hiddenIframe.onload=null}function saveUrl(){saveCookie("currentUrl",jQuery("#currentUrl").val())}function loadUrl(){var url=readCookie("currentUrl");if(url&&url!=""){jQuery("#currentUrl").val(url);loadPage()}}function getSelectedLabel(selectObject){var selectedValues="";for(var i=0;i<selectObject.length;i++){if(selectObject.options[i].selected){return trimLine(selectObject.options[i].innerHTML)}}return selectedValues}function trimLine(str){return str.replace(/^[\s|\n]+|[\s|\n]+$/,"")}function getSel(){var txt="";txt=idoc().getSelection();return txt}function assertPresent(){var t=getSel();if(t&&t!=""){addToList('tester.assertTextPresent("'+t+'");')}}function assertCollapsedText(){var t=getSel();if(t&&t!=""){t=collapseWhitespace(t);addToList('text.assertTextPresent(new WebPageLocator(tester), "'+t+'");')}}var beforeTxt="";function assertBefore(){var t=getSel();if(t&&t!=""){if(beforeTxt!=""){addToList('assertTextPresentBeforeText("'+beforeTxt+'", "'+t+'");');beforeTxt="";jQuery("#assertBefore").html("Assert Before...")}else{beforeTxt=t;jQuery("#assertBefore").html('Assert after "'+beforeTxt+'"')}}}function displayAllIssues(){var searchBox=idoc().getElementById("quickSearchInput");searchBox.value="";searchBox.form.submit();addToList("// Display all issues in the Issue Navigator.");addToList("navigation.issueNavigator().displayAllIssues();")}function removeListItem(o){var parentLi=findParentNodeOfTag("LI",o);jQuery(parentLi).slideUp("fast",function(){jQuery(this).remove()})}function findParentNodeOfTag(nodeName,o){var parentNode=o.parentNode;while(parentNode){if(parentNode.nodeName==nodeName){return parentNode}else{parentNode=parentNode.parentNode}}return }htmlEsc=function(str){var div=document.createElement("div");var text=document.createTextNode(str);div.appendChild(text);return div.innerHTML};var commands=[];function removeAllCommands(){jQuery("#commands li").remove();commands=[]}function addResponseToList(originalRequest){info("Response: "+originalRequest.responseText);addToList(originalRequest.responseText)}function addToList(message){commands.push(message);jQuery("#commandsList").append(jQuery(document.createElement("li")).html("<a class='deleteLink' href='#' onclick='removeListItem(this);return false;'>del</a>"+htmlEsc(message)));var getScrollPosition=function(){return(jQuery("#commandsInner").get(0).scrollHeight-jQuery("#commandsInner").outerHeight())};if(getScrollPosition()>jQuery("#commandsInner").scrollTop()){jQuery("#commandsInner").animate({scrollTop:getScrollPosition()},300,"linear")}}function extractCommands(){jQuery("#commandsText").css("display","");var commandsLis=commands;var s="";for(var i=0;i<commandsLis.length;i++){var command=commandsLis[i];s=s+command+"\n"}jQuery("#commandsText").val(s);jQuery("#commandsText").focus()}function refreshTools(){refreshTableTool();refreshFormTool()}function refreshTableTool(){var ddTable=document.getElementById("ddTable");ddTable.innerHTML="";var blankOption=document.createElement("option");blankOption.appendChild(document.createTextNode(""));ddTable.appendChild(blankOption);var tables=idoc().getElementsByTagName("table");for(var i=0;i<tables.length;i++){var tableID=tables[i].getAttribute("id");if(tableID){var newOption=document.createElement("option");newOption.appendChild(document.createTextNode(tableID));ddTable.appendChild(newOption)}}}function refreshFormTool(){var ddForm=document.getElementById("ddForm");ddForm.innerHTML="";var blankOption=document.createElement("option");blankOption.appendChild(document.createTextNode(""));ddForm.appendChild(blankOption);var forms=idoc().getElementsByTagName("form");for(var i=0;i<forms.length;i++){var formName=forms[i].getAttribute("name");if(formName){var newOption=document.createElement("option");newOption.appendChild(document.createTextNode(formName));ddForm.appendChild(newOption)}}}function doTableAction(){var ddTable=document.getElementById("ddTable");var tableID=ddTable.options[ddTable.selectedIndex].value;var ddTableAction=document.getElementById("ddTableAction");var action=ddTableAction.options[ddTableAction.selectedIndex].value;if(action=="AssertAllRowsInOrder"){doTableActionAssertAllRowsInOrder(tableID)}else{if(action=="AssertAllRowsVerbose"){doTableActionAssertAllRowsVerbose(tableID)}else{if(action=="AssertAllRowsNoOrder"){doTableActionAssertAllRowsNoOrder(tableID)}else{if(action=="GetWebTableObject"){doTableActionGetWebTableObject(tableID)}else{alert("ERROR: Unknown action '"+action+"'")}}}}}function doTableActionAssertAllRowsInOrder(tableID){addToList("// Assert the table '"+tableID+"'");var table=idoc().getElementById(tableID);var rows=table.rows;addToList("final ExpectedTable expectedTable = new ExpectedTable();");for(var i=0;i<rows.length;i++){var codeForRow="expectedTable.appendRow(new ExpectedRow(new String[] {";var cells=rows[i].cells;var firstCell=true;for(var cellNum=0;cellNum<cells.length;cellNum++){if(firstCell){firstCell=false}else{codeForRow=codeForRow+", "}var text=stripText(cells[cellNum]);text=escapeTextForJavaString(trim(text));codeForRow=codeForRow+'"'+text+'"'}codeForRow=codeForRow+"}));";addToList(codeForRow)}addToList('tester.assertTableEquals("'+tableID+'", expectedTable);')}function doTableActionAssertAllRowsVerbose(tableID){addToList("// Assert the cells in table '"+tableID+"'.");addToList("WebTable "+tableID+' = tester.getDialog().getWebTableBySummaryOrId("'+tableID+'");');var table=idoc().getElementById(tableID);var rows=table.rows;for(var rowNum=0;rowNum<rows.length;rowNum++){var commentForRow="// Assert row "+rowNum+": |";var cells=rows[rowNum].cells;var assertion=[];for(var cellNum=0;cellNum<cells.length;cellNum++){var text=stripText(cells[cellNum]);commentForRow=commentForRow+collapseWhitespace(text)+"|";var escapedText=escapeTextForJavaString(trim(text));assertion[cellNum]='assertEquals("Cell ('+rowNum+", "+cellNum+") in table '"+tableID+"' should be '"+escapedText+'\'.", "'+escapedText+'", '+tableID+".getCellAsText("+rowNum+", "+cellNum+").trim());"}addToList(commentForRow);for(var cellNum=0;cellNum<cells.length;cellNum++){addToList(assertion[cellNum])}}}function doTableActionGetWebTableObject(tableID){addToList("WebTable "+tableID+' = tester.getDialog().getWebTableBySummaryOrId("'+tableID+'");')}function doTableActionAssertAllRowsNoOrder(tableID){addToList("// Assert the table '"+tableID+"'");var table=idoc().getElementById(tableID);var rows=table.rows;addToList("WebTable "+tableID+' = tester.getDialog().getWebTableBySummaryOrId("'+tableID+'");');addToList('assertEquals("Expected table to have '+rows.length+' rows, but found " + '+tableID+".getRowCount(), "+rows.length+", "+tableID+".getRowCount());");for(var i=0;i<rows.length;i++){var codeForRow="assertions.getTableAssertions().assertTableContainsRowOnce("+tableID+", new String[] {";var cells=rows[i].cells;var firstCell=true;for(var cellNum=0;cellNum<cells.length;cellNum++){if(firstCell){firstCell=false}else{codeForRow=codeForRow+", "}var text=stripText(cells[cellNum]);text=collapseWhitespace(text);text=escapeTextForJavaString(trim(text));codeForRow=codeForRow+'"'+text+'"'}codeForRow=codeForRow+"});";addToList(codeForRow)}}function doFormAction(){var form=getSelectedForm();var ddFormAction=document.getElementById("ddFormAction");var action=ddFormAction.options[ddFormAction.selectedIndex].value;var ddFormComponent=document.getElementById("ddFormComponent");var componentName=ddFormComponent.options[ddFormComponent.selectedIndex].value;if(componentName=="VISIBLE"){doFormActionAssertComponents(form,action,false)}else{if(componentName=="ALL"){doFormActionAssertComponents(form,action,true)}else{var component=getElementNamed(form,componentName);doFormActionAssertSingleComponent(component,action)}}}function getElementNamed(form,elementName){var elements=form.elements;for(var i=0;i<elements.length;i++){if(elements[i].name==elementName){return elements[i]}}return null}function doFormActionAssertComponents(form,action,includeHidden){addToList("// Assert the values of form '"+form.name+"'.");addToList('tester.assertFormPresent("'+form.name+'");');var elements=form.elements;for(var i=0;i<elements.length;i++){var component=elements[i];if(includeHidden||component.type!="hidden"){doFormActionAssertSingleComponent(component,action)}}}function doFormActionAssertSingleComponent(component,action){if(action=="AssertComponentValue"){addToList("// Assert that the value of "+component.type+" component '"+component.name+"' = \""+component.value+'".');addToList('tester.assertFormElementEquals("'+component.name+'", "'+component.value+'");')}else{if(action=="AssertComponentPresent"){addToList("// Assert that the "+component.type+" component '"+component.name+"' is present.");addToList('tester.assertFormElementPresent("'+component.name+'");')}else{alert("Unknown action '"+action+"'")}}}function stripText(node){if(node.nodeName=="#text"){return node.nodeValue}var children=node.childNodes;if(children){var text="";for(var i=0;i<children.length;i++){text=text+stripText(children[i])}return text}else{return""}}function escapeTextForJavaString(str){var newStr=str;newStr=newStr.replace(new RegExp("\\\\","g"),"\\\\");newStr=newStr.replace(new RegExp('"',"g"),'\\"');newStr=newStr.replace(new RegExp("\t","g"),"\\t");newStr=newStr.replace(new RegExp("\n","g"),"\\n");newStr=newStr.replace(new RegExp("\r","g"),"\\r");return newStr}function collapseWhitespace(str){var newStr;newStr=str.replace(new RegExp("\\s+","g")," ");return trim(newStr)}function trim(str,chars){return ltrim(rtrim(str,chars),chars)}function ltrim(str,chars){chars=chars||"\\s";return str.replace(new RegExp("^["+chars+"]+","g"),"")}function rtrim(str,chars){chars=chars||"\\s";return str.replace(new RegExp("["+chars+"]+$","g"),"")}function ddTableValueChanged(){var tableID=getSelectedTableID();var selectedTable=idoc().getElementById(tableID);selectObject(selectedTable)}function ddFormValueChanged(){var form=getSelectedForm();selectObject(form);if(form){var dropDown=document.getElementById("ddFormComponent");dropDown.innerHTML="";var newOption=document.createElement("option");newOption.appendChild(document.createTextNode("All Visible"));newOption.value="VISIBLE";dropDown.appendChild(newOption);newOption=document.createElement("option");newOption.appendChild(document.createTextNode("All inc. hidden"));newOption.value="ALL";dropDown.appendChild(newOption);var forms=idoc().getElementsByTagName("form");for(var i=0;i<forms.length;i++){}var elements=form.elements;for(var i=0;i<elements.length;i++){var elementName=elements[i].getAttribute("name");if(elementName){newOption=document.createElement("option");newOption.appendChild(document.createTextNode(elementName));dropDown.appendChild(newOption)}}}else{var dropDown=document.getElementById("ddFormComponent");dropDown.innerHTML=""}}function ddFormComponentValueChanged(){var ddFormComponent=document.getElementById("ddFormComponent");var componentName=ddFormComponent.options[ddFormComponent.selectedIndex].value;if(componentName=="VISIBLE"){selectObject(getSelectedForm())}else{if(componentName=="ALL"){selectObject(getSelectedForm())}else{var component=getElementNamed(getSelectedForm(),componentName);selectObject(component)}}}var selectedObject;var old_style;function selectObject(newlySelected){if(selectedObject){selectedObject.setAttribute("style",old_style);selectedObject=null}if(newlySelected){old_style=newlySelected.getAttribute("style");selectedObject=newlySelected;selectedObject.setAttribute("style","border-style: solid; border-width: 5px; border-color: #FF0000;")}}function getSelectedForm(){var ddForm=document.getElementById("ddForm");var idx=ddForm.selectedIndex;if(idx<1){return null}return idoc().forms[ddForm.selectedIndex-1]}function getSelectedFormName(){var ddForm=document.getElementById("ddForm");return ddForm.options[ddForm.selectedIndex].value}function getSelectedTableID(){var ddTable=document.getElementById("ddTable");return ddTable.options[ddTable.selectedIndex].value};